{
  "general": {
    "interactive_mode": true,
    "default_output_dir": "downloaded_works",
    "default_csv_path": "sample_works.csv"
  },
  "providers": {
    "internet_archive": true,
    "bnf_gallica": true,
    "loc": false,
    "europeana": true,
    "dpla": false,
    "ddb": true,
    "british_library": false,
    "mdz": true,
    "polona": true,
    "bne": false,
    "google_books": false,
    "hathitrust": false,
    "wellcome": true,
    "annas_archive": true
  },
  "provider_settings": {
    "mdz": {
      "max_pages": 0,
      "min_title_score": 45,
      "_quota_note": "No daily quota - unlimited downloads with rate limiting only",
      "network": {
        "delay_ms": 300,
        "jitter_ms": 150,
        "max_attempts": 25,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30
      }
    },
    "gallica": {
      "max_pages": 0,
      "min_title_score": 45,
      "_quota_note": "No daily quota - unlimited downloads with rate limiting only",
      "network": {
        "delay_ms": 4000,
        "jitter_ms": 800,
        "max_attempts": 25,
        "base_backoff_s": 2.0,
        "backoff_multiplier": 1.6,
        "max_backoff_s": 90.0,
        "timeout_s": 30
      }
    },
    "loc": {
      "max_pages": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 300,
        "jitter_ms": 150,
        "max_attempts": 5,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30,
        "headers": { "Accept": "application/json" }
      }
    },
    "ddb": {
      "max_pages": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 400,
        "jitter_ms": 200,
        "max_attempts": 5,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30
      }
    },
    "polona": {
      "max_pages": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 600,
        "jitter_ms": 200,
        "max_attempts": 8,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30
      }
    },
    "europeana": {
      "max_pages": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 400,
        "jitter_ms": 200,
        "max_attempts": 8,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30
      }
    },
    "dpla": {
      "max_pages": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 400,
        "jitter_ms": 200,
        "max_attempts": 8,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30,
        "headers": { "Accept": "application/json" }
      }
    },
    "google_books": {
      "free_only": true,
      "prefer": "pdf",
      "allow_drm": false,
      "max_files": 1000,
      "min_title_score": 50,
      "network": {
        "delay_ms": 2000,
        "jitter_ms": 500,
        "max_attempts": 3,
        "base_backoff_s": 2.0,
        "backoff_multiplier": 2.0,
        "max_backoff_s": 30.0,
        "timeout_s": 30,
        "circuit_breaker_enabled": true,
        "circuit_breaker_threshold": 2,
        "circuit_breaker_cooldown_s": 600.0,
        "headers": { "Referer": "https://books.google.com/" }
      }
    },
    "wellcome": {
      "max_images": 0,
      "min_title_score": 50,
      "network": {
        "delay_ms": 300,
        "jitter_ms": 150,
        "max_attempts": 8,
        "base_backoff_s": 1.5,
        "backoff_multiplier": 1.5,
        "max_backoff_s": 60.0,
        "timeout_s": 30
      }
    },
    "annas_archive": {
      "max_pages": 0,
      "min_title_score": 70,
      "quota": {
        "enabled": true,
        "daily_limit": 75,
        "reset_hours": 24,
        "wait_for_reset": true,
        "_note": "Anna's Archive fast download API has a daily quota (member feature)"
      },
      "daily_fast_download_limit": 75,
      "wait_for_quota_reset": true,
      "quota_reset_wait_hours": 24,
      "network": {
        "delay_ms": 800,
        "jitter_ms": 300,
        "max_attempts": 5,
        "base_backoff_s": 2.0,
        "backoff_multiplier": 2.0,
        "max_backoff_s": 45.0,
        "timeout_s": 45,
        "ssl_error_policy": "retry_insecure_once",
        "_note": "Rate limiting delays (applies to all requests, separate from quota). SSL policy allows retry without verification due to frequent certificate issues."
      }
    }
  },
  "download": {
    "resume_mode": "skip_if_has_objects",
    "prefer_pdf_over_images": true,
    "download_manifest_renderings": true,
    "max_renderings_per_manifest": 5,
    "rendering_mime_whitelist": ["application/pdf", "application/epub+zip"],
    "overwrite_existing": false,
    "include_metadata": true,
    "allowed_object_extensions": [".pdf", ".epub", ".jpg", ".jpeg", ".png", ".jp2", ".tif", ".tiff", ".webp", ".bmp", ".gif"],
    "save_disallowed_to_metadata": true,
    "_resume_mode_options": ["skip_completed", "reprocess_all", "skip_if_has_objects", "resume_from_csv"],
    "_resume_mode_note": "resume_from_csv uses the retrievable column in the source CSV for resume logic",
    "max_parallel_downloads": 10,
    "provider_concurrency": {
      "default": 5,
      "annas_archive": 1,
      "bnf_gallica": 1,
      "google_books": 1,
      "internet_archive": 3,
      "mdz": 2,
      "wellcome": 2
    },
    "queue_size": 100,
    "worker_timeout_s": 600
  },
  "selection": {
    "strategy": "collect_and_select",
    "max_parallel_searches": 10,
    "provider_hierarchy": [
      "mdz",
      "bnf_gallica",
      "annas_archive",
      "internet_archive",
      "wellcome",
      "google_books",
      "loc",
      "europeana",
      "dpla",
      "ddb",
      "polona",
      "hathitrust"
    ],
    "min_title_score": 50,
    "creator_weight": 0.2,
    "year_tolerance": 2,
    "max_candidates_per_provider": 5,
    "download_strategy": "selected_only",
    "keep_non_selected_metadata": false
  },
  "naming": {
    "include_creator_in_work_dir": true,
    "include_year_in_work_dir": true,
    "title_slug_max_len": 80
  },
  "download_limits": {
    "total": {
      "images_gb": 100,
      "pdfs_gb": 50,
      "metadata_gb": 1
    },
    "per_work": {
      "images_gb": 5,
      "pdfs_gb": 3,
      "metadata_mb": 250
    },
    "on_exceed": "stop"
  },
  "deferred": {
    "background_enabled": true,
    "queue_file": ".deferred_queue.json",
    "quota_state_file": ".quota_state.json",
    "check_interval_minutes": 15,
    "max_retries": 5,
    "_note": "Background scheduler monitors quota-limited downloads and retries when quotas reset"
  },
  "_csv_format_note": "Expects sampling notebook format: entry_id, short_title, main_author, retrievable, link columns"
}
